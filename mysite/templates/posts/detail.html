<!-- Created by Yamamoto Sota -->

{% extends "base_header.html" %}
{% load static %}

<!DOCTYPE html>
<html kang="ja">
    <head>
        {% block head %}
        <link rel="stylesheet" type="text/css" href="{% static 'posts/thread.css' %}">
		    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" />
        <title>スレッド画面</title>
        {% endblock head %}
    </head>
    <body>
      {% block contents %}
        <div class = "post">
            <P class = "post">
                <img src="{{ book.cover_path }}" class="bookicon" alt="bookicon" align="middle">
                {{ post.content }}
            </P>
            <div class = "bookinfo">
              <p class = "author">- {{ book.author }} </p>
              <p class = "booktitle">{{ book.title }}</p>
            </div>
        </div>
        <div class = "contents">
          {% if zipped_comments %}
            <ul>
              {% for comment, user, num_nice, comment_perm in zipped_comments %}
                <div class = "box">
                  <div class = "comment">
                    <div class = "userinfo">
                        <p class = "username">{{ user.username }}</p>
                        <p class = "time">{{ post.updated_at }}</p>
                    </div>
                    <p>
                        <p class = "id">1：</p>
                        <p class = "comment">{{ comment.comment }}</p>
                    </p>
                    <form action="{% url 'nice' %}" method="post">
                    {% csrf_token %}
                    <input type="hidden", name='comment_id', value={{ comment.id }}>
                    <input type="submit" value="いいね！">
                    {{ num_nice }}
                    </form>
                    {% if comment_perm %}
                      <p> Post comment </p>
                      <form action="{% url 'comment_edit' comment.id %}" method="post">
                        {% csrf_token %}
                        <textarea name="comment" rows="8" cols="100">
                        </textarea>
                        <input type="submit" value="編集">
                      </form>
                      <p> Delete comment </p>
                      <form action="{% url 'comment_delete' comment.id %}" method="post">
                        {% csrf_token %}
                        <input type="submit" value="削除">
                      </form>
                    {% endif %}
                  </div>
                </div>
              {% endfor %}
            </ul>
          {% else %}
            <p>No comments are available.</p>
          {% endif %}
        </div>
        {% if user.is_authenticated %}
          <div class = "post_comment">
            <form method="POST" action="{% url 'comment_create' post.id %}">
                  <p class="username">
                  <img src="{% static 'posts/img/bookusagi.png' %}" width="55px" class="icon" alt="icon" align="middle">
                  Username
                  </p>
                  <textarea name="comment" rows="8" cols="100">
                  </textarea>
                  {% csrf_token %}
                  <br><br>
                  <input type="submit" name="btn1" value="投稿する">
              </form>
          </div>
          <button class="fixed-btn">投稿</button>
        {% endif %}
      {% endblock contents %}
    </body>
</html>
